<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="./meta/main.css"><title>Add Images to Ayano's Comment Widget | Da Blog</title></head>
<body>
    <div id="container"><div id="nav">
    <div>
        <nav>
            <a href="./index">üè†Ô∏é</a>
            <a href="./../about/index.html#from-blog">about me</a>
            <a href="./archive">archive</a>
            <a href="#micro">micro</a>
            <a href="#" onclick="randomPost()">random</a>
            <a href="./../index.html">‚úÆ head back ¬ª</a>
            <div id="nextprev-dup"></div>
        </nav>
    </div>
</div>

<script>
function randomPost(){
    fetch("/blog/meta/posts.json")
        .then((response) => response.json())
        .then((posts) => {
            randomNum = Math.floor(Math.random() * posts.length);
            window.location.href = posts[randomNum]
    })
}
</script><header class="main">
    <div>
		<a href="#">ü¢Ç</a>
		Da Blog!!
	</div>
</header><main class="page-content" aria-label="Content">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="main-content post-header"><img src="./img/ayano-mod.jpg" alt="" style="max-width: 300px;"/><div id="blog-title">
    <h1 itemprop="name headline">Add Images to Ayano&#39;s Comment Widget</h1>
</div><div id="blog-date">
    <p class="post-meta">
        <time class="dt-published" datetime="2025-07-20T00:00:00+08:00" itemprop="datePublished">Jul 20, 2025
        </time></p>
</div></header>

  <div class="main-content post-content e-content" itemprop="articleBody">
    <div class="mew">
    <p>I've recently made a switch to <a href="https://virtualobserver.moe/ayano/comment-widget" target="_blank">Ayano's Comment Widget</a> and, as much as I adore it, I missed having the option to attach images. Luckily, the code is incredibly customizable so with a bit of tweaking, it is possible!</p>
    
    <p>This mod allows users to submit a link of an image that will be attached to their comments. If this is something you'd like to have, follow the steps below.</p>
    
    <h2>[1] Add to Google Form</h2>
    <p>Assuming you've already set everything prior to this, Go to your google form and create a new short text question with the title 'Image'. Remember that it is case sensitive!</p>
    
    <p>Open the three dotted icon to the right side and click 'Get pre-filled link'. Fill up every field with the question's title, including the new one you just made. Once you have finished and click 'Get link', you should get a newly generated link where you will be able to find something that looks like this:</p>
    
    <pre>
    <code>
    &entry.123456789=Image
    </code>
    </pre>
    
    <p>In your js file, look for the section of variables of the form ids. You can add the script after <code>const s_replyId = 'ID HERE';</code> and encode the numbers from your form link.</p>
    
    <pre>
    <code>
    const s_imageId = '1234567890'
    </code>
    </pre>
    
    <h2>[2] Add Element Wrappers</h2>
    <p>To create the input the user will add their image links to, look for the <code>v_formHtml</code> variable. Inside it, there should be a div with <code>id="c_textWrapper"</code> and add the following script below that element:</p>
    
    <pre>
    <code>
    &#x3C;div id=&#x22;c_imageWrapper&#x22; class=&#x22;c-inputWrapper&#x22;&#x3E;
        &#x3C;label class=&#x22;c-label c-imageLabel&#x22; for=&#x22;entry.${s_imageId}&#x22;&#x3E;Image Link (Optional)&#x3C;/label&#x3E;
        &#x3C;input class=&#x22;c-input c-imageInput&#x22; name=&#x22;entry.${s_imageId}&#x22; id=&#x22;entry.${s_imageId}&#x22; type=&#x22;url&#x22; pattern=&#x22;https://.*&#x22; placeholder=&#x22;&#x22; onchange=&#x22;previewImg()&#x22;&#x3E;
    &#x3C;/div&#x3E;
    </code>
    </pre>
    
    <p>We need to create a preview so that the users are able to see what image they have linked and whether or not it will load in. Still inside the <code>v_formHtml</code> variable, look for the input with <code>id="c_submitButton"</code> and then add the following script after it. </p>
    
    <pre>
    <code>
    &#x3C;div id=&#x22;c_previewWrapper&#x22;&#x3E;
        &#x3C;img id=&#x22;c_previewOutput&#x22; src=&#x22;#&#x22;&#x3E;
        &#x3C;label class=&#x22;c-label c-previewLabel&#x22;&#x3E;Image Preview&#x3C;/label&#x3E;
        &#x3C;p&#x3E;If the image does not load, please make sure the website you are linking to allows &#x3C;a href=&#x22;https://simple.wikipedia.org/wiki/Hotlinking&#x22; target=&#x22;_blank&#x22;&#x3E;hotlinking&#x3C;/a&#x3E;!&#x3C;/p&#x3E;
    &#x3C;/div&#x3E;
    </code>
    </pre>
    
    <h2>[3] Add the Functions</h2>
    <p>Now that we've set up all the variables, it's time to make them actually functional.</p>
    
    <p>Look for <code>if (s_commentsOpen)</code> inside of <code>function getComments()</code> - there should be a comment above it that reads 'Clear input fields too'. You should add the following script below inside of that if statement:</p>
    
    <pre>
    <code>
    document.getElementById(`entry.${s_imageId}`).value = '';
    </code>
    </pre>
    
    <p>In order to check and append the comment's image, look for <code>function createComment(data)</code>. Inside should be <code>comment.appendChild(text);</code>. Below that you should put the following script:</p>
    
    <pre>
    <code>
    // Image link
    if (data.Image) {
        let img = document.createElement('img')
        img.src = data.Image
        img.className = 'c-img'
        comment.appendChild(img)
    }
    </code>
    </pre>
    
    <p>It won't matter too much where you choose to put this last script. It is a function that is triggered every time the user changes the image field. I personally put it at the bottom before <code>getComments();</code>.</p>
    
    <pre>
    <code>
    function previewImg() {
        previewWrapper = document.getElementById("c_previewWrapper")
        previewLink = document.getElementById(`entry.${s_imageId}`).value
        if (previewLink.length === 0) {
            previewWrapper.style.display = "none"
            previewLink = "#"
        } else {
            previewWrapper.style.display = "block"
        }
        document.getElementById("c_previewOutput").src = previewLink
    }
    </code>
    </pre>
    
    <h2>[4] Add CSS Styling</h2>
    <p>This part isn't necessary but it makes the preview look a bit nicer.</p>
    
    <pre>
    <code>
    #c_previewWrapper:has(img[src='#']) { display:none }
    #c_previewWrapper {
        padding: 0.5rem;
        border: 1px solid gray;
        max-width:350px;
        margin-bottom: 0.5rem;
    }
    
    #c_previewOutput { max-width: 100%; display: block; }
    #c_previewWrapper p {
        font-size: 0.8rem;
        opacity: 0.5;
    }
    
    .c-img {display: block;}
    </code>
    </pre>
    
    <h2>And You're Done!</h2>
    <p>I highly recommend using this mod alongside <a href="https://frills.dev/blog/231023-add-moderation-to-comment-widget/" target="_blank">Frills' Guide to Adding Moderation</a> so you can check and ensure that the comments being submitted don't contain disturbing images.</p>
    
    <p>If you get around to using to using this, let me know down below. I'd love to check out all of your websites!</p>
    <img src="./img/sign-off.png" alt="" class="sign-off">
</div>

<style>
main {min-width: 0;}
.mew h2 {margin-top: 2rem;}
p > code, li > code {color:var(--accent-color); font-weight: bolder;}
pre {
    border: 1px dashed var(--txt-color);
    code { 
        display: block;
        padding: 0 1rem;    
        overflow: auto;
    }
}
</style>
  </div>

  <div class="main-content"><div id="nextprev">
    
        <a href="./2025-08-18-Genderswaps.html" id='nextprev-next'>Next</a>
    
    
        <a href="./2025-07-02-Coloring.html" id='nextprev-prev'>Prev</a>
    
    <a href="./archive" id='nextprev-archive'>Archive</a>
</div><div id="c_widget"></div>
    <script>
        var script = document.createElement('script');
        script.src = "/meta/comment-widget.js";
        document.head.appendChild(script);
    </script>
  </div>
  <a class="u-url" href="./2025-07-20-Comments.html" hidden></a>

</article>
      </main><footer>
    <div>
        <a href="/about/index.html">about</a>
        <a href="/map.html">map</a>
        <a href="./feed.xml">rss</a>
    </div>
</footer>
</div>
    <script src="./meta/main.js"></script>
  </body>
</html>